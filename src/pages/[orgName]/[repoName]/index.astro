---
import Layout from "@src/layouts/Layout.astro";
import { octokit } from "@src/utils/octokit";
import EnvironmentList from "@src/components/EnvironmentList";
import Breadcrumbs from "@src/components/Breadcrumbs";

const { orgName, repoName } = Astro.params;

const {
  data: { environments = [] },
} = await octokit.request("GET /repos/{owner}/{repo}/environments", {
  owner: orgName!,
  repo: repoName!,
  headers: {
    "X-GitHub-Api-Version": "2022-11-28",
  },
});
---

<Layout>
  <Breadcrumbs names={[orgName!, repoName!]} />
  <EnvironmentList
    orgName={orgName!}
    repoName={repoName!}
    environments={environments}
  />
</Layout>
